<div class="property-container">
    <div class="property-header">
        <div class="title-group">
            <h2>Property Command</h2>
            <span id="header-stats" class="badge-count">0 Properties</span>
        </div>
        <div class="property-controls">
            <button id="btn-add-property" class="action-btn primary">+ Add</button>
            <button id="btn-paste-property" class="action-btn secondary" title="Paste Bookmarklet Data">üìã
                Paste</button>

            <div class="button-group">
                <button id="btn-copy-new-ai" class="action-btn secondary" style="border-right:1px solid #ccc;">‚ú® Copy
                    New</button>
                <button id="btn-copy-bulk-ai" class="action-btn secondary">ü§ñ Copy All</button>
            </div>

            <button id="btn-compare-trigger" class="action-btn secondary"
                style="border: 1px solid #2e7d32; color: #2e7d32;">‚öñÔ∏è Compare</button>

            <button id="btn-bulk-ai" class="action-btn secondary">üì• Bulk Update</button>
            <button id="btn-export-csv" class="action-btn secondary">Export CSV</button>
            <button id="btn-import-csv-trigger" class="action-btn secondary">Import CSV</button>
            <input type="file" id="csv-upload" accept=".csv" style="display: none;">
        </div>
    </div>

    <div id="filter-bar-container"></div>

    <div id="property-grid-view" class="property-grid"></div>

    <div id="compare-modal" class="modal hidden">
        <div class="modal-content"
            style="width: 95%; max-width: 1200px; max-height: 90vh; display: flex; flex-direction: column;">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom: 15px;">
                <h4>‚öñÔ∏è Head-to-Head Comparison</h4>
                <button id="btn-close-compare" class="action-btn secondary">Close</button>
            </div>
            <div id="compare-table-container" style="overflow-y: auto;">
            </div>
        </div>
    </div>

    <div id="bulk-ai-modal" class="modal hidden">
        <div class="modal-content">
            <h4>üì• Bulk AI Update</h4>
            <p>Paste the JSON array provided by the AI below.</p>
            <textarea id="bulk-ai-input" placeholder='[{"mls":"R123", "aiEst": 850000...}, ...]'></textarea>
            <div class="modal-actions">
                <button id="btn-close-bulk" class="action-btn secondary">Cancel</button>
                <button id="btn-apply-bulk" class="action-btn primary">Apply All</button>
            </div>
        </div>
    </div>

    <div id="property-detail-view" class="property-detail hidden">
        <div class="detail-header">
            <button id="btn-back-grid" class="back-btn">&larr; Back</button>
            <h3 id="detail-title-display">Edit Property</h3>
            <div class="header-actions">
                <button id="btn-copy-ai" class="action-btn secondary">ü§ñ AI Prompt</button>
                <a id="link-external" href="#" target="_blank" class="action-btn secondary">üîó Link</a>
                <button id="btn-save-property" class="action-btn primary">Save</button>
            </div>
        </div>

        <div class="detail-content">
            <div class="detail-grid">

                <div class="detail-main">

                    <div class="detail-section">
                        <h4>üìå Vital Stats</h4>
                        <div class="form-row">
                            <div class="input-group full-width">
                                <label>Title (Nickname)</label>
                                <input type="text" id="prop-title">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="input-group">
                                <label>MLS #</label>
                                <input type="text" id="prop-mls">
                            </div>
                            <div class="input-group">
                                <label>Status</label>
                                <select id="prop-status">
                                    <option value="Watchlist">üëÄ Watchlist</option>
                                    <option value="Active">üü¢ Active</option>
                                    <option value="Viewing">üìÖ Viewing</option>
                                    <option value="Offer">‚úçÔ∏è Offer</option>
                                    <option value="Sold">üî¥ Sold</option>
                                    <option value="Passed">üö´ Passed</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="input-group">
                                <label>Address</label>
                                <input type="text" id="prop-address">
                            </div>
                            <div class="input-group">
                                <label>City</label>
                                <input type="text" id="prop-city">
                            </div>
                        </div>
                        <input type="hidden" id="prop-url">
                        <input type="hidden" id="prop-img">
                    </div>

                    <div class="detail-section">
                        <h4>üè† House & Infrastructure</h4>
                        <div class="form-row">
                            <div class="input-group"><label>Bedrooms</label><input type="number" id="prop-bed"></div>
                            <div class="input-group"><label>Bathrooms</label><input type="number" id="prop-bath"></div>
                            <div class="input-group">
                                <label>Suite?</label>
                                <select id="prop-suite">
                                    <option value="No">No</option>
                                    <option value="Yes">Yes</option>
                                    <option value="Potential">Potential</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="input-group"><label>House Size</label><input type="number" id="prop-houseSize">
                            </div>
                            <div class="input-group"><label>Land Size</label><input type="text" id="prop-landSize">
                            </div>
                            <div class="input-group"><label>Zoning</label><input type="text" id="prop-zoning"></div>
                        </div>
                        <div class="form-row">
                            <div class="input-group"><label>Power</label><input type="text" id="prop-power"></div>
                            <div class="input-group"><label>Water</label><input type="text" id="prop-water"></div>
                        </div>
                        <div class="form-row">
                            <div class="input-group full-width"><label>Features</label><textarea id="prop-features"
                                    style="height:60px;"></textarea></div>
                        </div>
                        <div class="form-row">
                            <div class="input-group full-width"><label>üõ†Ô∏è Maintenance & Repair Notes</label><textarea
                                    id="prop-notes" placeholder="e.g., Needs new roof..."
                                    style="height:80px;"></textarea></div>
                        </div>
                    </div>

                    <div class="detail-section">
                        <h4>üî• Risk & Proximity</h4>
                        <div class="form-row">
                            <div class="input-group"><label>Fire Risk (1-5)</label><input type="number"
                                    id="prop-riskFire"></div>
                            <div class="input-group"><label>Climate Risk (1-5)</label><input type="number"
                                    id="prop-riskClimate"></div>
                            <div class="input-group"><label>Dist. Fire (km)</label><input type="number"
                                    id="prop-distFire"></div>
                        </div>
                        <div class="form-row">
                            <div class="input-group"><label>Dist. City</label><input type="number" id="prop-distCity">
                            </div>
                            <div class="input-group"><label>Grocery</label><input type="number" id="prop-distGrocery">
                            </div>
                            <div class="input-group"><label>Hospital</label><input type="number" id="prop-distHospital">
                            </div>
                        </div>
                    </div>

                    <div class="detail-section">
                        <h4>‚ù§Ô∏è Vibe Check</h4>
                        <div class="vibe-grid">
                            <div class="vibe-col">
                                <h5>You</h5><input type="number" id="rate-user-score" placeholder="1-10"><textarea
                                    id="rate-user-note" placeholder="Notes..."></textarea>
                            </div>
                            <div class="vibe-col">
                                <h5>Spouse</h5><input type="number" id="rate-spouse-score" placeholder="1-10"><textarea
                                    id="rate-spouse-note" placeholder="Notes..."></textarea>
                            </div>
                            <div class="vibe-col">
                                <h5>Realtor</h5><input type="number" id="rate-realtor-score"
                                    placeholder="1-10"><textarea id="rate-realtor-note"
                                    placeholder="Notes..."></textarea>
                            </div>
                        </div>
                    </div>

                    <div class="detail-section">
                        <h4>üìé Documents & Links</h4>
                        <div id="prop-links-container"
                            style="display: flex; flex-direction: column; gap: 8px; margin-bottom: 15px;">
                        </div>
                        <div class="form-row" style="align-items: flex-end;">
                            <div class="input-group">
                                <label>Link Name (e.g. Shared Folder)</label>
                                <input type="text" id="new-link-name" placeholder="File Name...">
                            </div>
                            <div class="input-group">
                                <label>URL Address</label>
                                <input type="url" id="new-link-url" placeholder="https://...">
                            </div>
                            <button id="btn-add-link" class="action-btn secondary" style="margin-bottom: 2px;">+
                                Add</button>
                        </div>
                        <button id="btn-delete-property" class="action-btn danger"
                            style="width:100%; margin-top:30px;">Delete Property</button>
                    </div>

                </div>

                <div class="detail-side">
                    <div class="summary-card">
                        <h4>üí∞ Financials</h4>
                        <div class="calc-row"><span>List Price</span><input type="number" id="prop-price"></div>
                        <div class="calc-row"><span>AI Est. Value</span><input type="number" id="prop-aiEst"
                                style="border-color:#a5d6a7; background:#1b5e20;"></div>
                        <div class="calc-row"><span>Tax/Yr</span><input type="number" id="prop-tax"></div>
                        <div class="calc-row"><span>Utils/Mo</span><input type="number" id="prop-carryUtils"></div>
                        <hr style="opacity:0.3; margin:10px 0;">
                        <div class="calc-row"><span>Mortgage</span><input type="number" id="calc-mortgage"></div>
                        <div class="calc-row"><span>Rate %</span><input type="number" id="calc-rate" step="0.1"
                                value="5.2"></div>
                        <div id="calc-result" class="total-result">$0 / mo</div>
                    </div>

                    <div class="detail-section ai-box" style="margin-top:20px; border: 2px dashed #2e7d32;">
                        <h4>ü§ñ AI Data Updater</h4>
                        <p style="font-size:0.8em; color:#666; margin-bottom:5px;">Paste the JSON code block from
                            ChatGPT here.</p>
                        <textarea id="ai-update-input" placeholder='{ "aiEst": 850000, ... }'></textarea>
                        <button id="btn-apply-ai" class="action-btn secondary full-width">Apply AI</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>